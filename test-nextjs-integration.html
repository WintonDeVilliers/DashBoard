<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 Racing Dashboard - Next.js Integration Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link href="https://cdn.tailwindcss.com/3.3.0" rel="stylesheet">
    <style>
        /* F1 Racing Theme Variables */
        :root {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --popover: 222.2 84% 4.9%;
            --popover-foreground: 210 40% 98%;
            --primary: 217.2 91.2% 59.8%;
            --primary-foreground: 222.2 84% 4.9%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 224.3 76.3% 94.1%;
            --radius: 0.5rem;
        }
        
        body {
            background: linear-gradient(135deg, hsl(var(--background)) 0%, #002b60 100%);
            color: hsl(var(--foreground));
            font-family: system-ui, -apple-system, sans-serif;
            min-height: 100vh;
        }
        
        .racing-gauge {
            position: relative;
            width: 300px;
            height: 150px;
            margin: 0 auto;
        }
        
        .gauge-bg {
            fill: none;
            stroke: #374151;
            stroke-width: 20;
        }
        
        .gauge-progress {
            fill: none;
            stroke-width: 20;
            stroke-linecap: round;
            transition: stroke-dasharray 0.5s ease;
        }
        
        .performance-superstar { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .performance-target { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }
        .performance-on-track { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .performance-needs-boost { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); }
        .performance-recovery { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        
        .circuit-monaco { background: linear-gradient(135deg, #002b60 0%, #0260f7 100%); }
        .circuit-kyalami { background: linear-gradient(135deg, #002b4d 0%, #e57200 100%); }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        // Mock Excel data for demonstration
        const mockExcelData = [
            {
                'Supervisor Name': 'Monaco Ashley',
                'Consultant Name': 'Moyo',
                'Current Sales': 480000,
                'Sales Target': 400000,
                'Achievement Rate %': 120
            },
            {
                'Supervisor Name': 'Monaco Ashley', 
                'Consultant Name': 'Mixo Makhubele',
                'Current Sales': 330000,
                'Sales Target': 400000,
                'Achievement Rate %': 82.5
            },
            {
                'Supervisor Name': 'Kyalami Sarah',
                'Consultant Name': 'Nonhle Zondi',
                'Current Sales': 310000,
                'Sales Target': 400000,
                'Achievement Rate %': 77.5
            },
            {
                'Supervisor Name': 'Kyalami Sarah',
                'Consultant Name': 'Rodney Smith',
                'Current Sales': 280000,
                'Sales Target': 400000,
                'Achievement Rate %': 70
            }
        ];
        
        // Excel processor simulation
        const processExcelData = (data) => {
            const consultants = data.map(row => ({
                id: Math.random().toString(36).substr(2, 9),
                name: row['Consultant Name'],
                supervisor: row['Supervisor Name'],
                current_sales: row['Current Sales'],
                sales_target: row['Sales Target'],
                achievement_rate: row['Achievement Rate %']
            }));
            
            const supervisors = [...new Set(consultants.map(c => c.supervisor))];
            const teams = supervisors.map(supervisor => {
                const teamConsultants = consultants.filter(c => c.supervisor === supervisor);
                const totalSales = teamConsultants.reduce((sum, c) => sum + c.current_sales, 0);
                const totalTarget = teamConsultants.reduce((sum, c) => sum + c.sales_target, 0);
                const avgAchievement = teamConsultants.reduce((sum, c) => sum + c.achievement_rate, 0) / teamConsultants.length;
                
                return {
                    id: Math.random().toString(36).substr(2, 9),
                    supervisor_name: supervisor,
                    consultants: teamConsultants,
                    total_sales: totalSales,
                    total_target: totalTarget,
                    team_achievement_rate: avgAchievement,
                    circuit: supervisor.includes('Monaco') ? 'monaco' : 'kyalami'
                };
            });
            
            return { consultants, teams };
        };
        
        // Performance calculation utilities
        const getPerformanceCategory = (achievementRate) => {
            if (achievementRate >= 120) return 'SUPERSTAR';
            if (achievementRate >= 100) return 'TARGET_ACHIEVED';
            if (achievementRate >= 80) return 'ON_TRACK';
            if (achievementRate >= 60) return 'NEEDS_BOOST';
            return 'RECOVERY_MODE';
        };
        
        const getPerformanceColor = (achievementRate) => {
            const category = getPerformanceCategory(achievementRate);
            const colors = {
                SUPERSTAR: '#22c55e',
                TARGET_ACHIEVED: '#3b82f6',
                ON_TRACK: '#f59e0b',
                NEEDS_BOOST: '#f97316',
                RECOVERY_MODE: '#ef4444'
            };
            return colors[category];
        };
        
        // Simple Racing Gauge Component
        const RacingGauge = ({ value, label, size = 150 }) => {
            const normalizedValue = Math.min(Math.max(value, 0), 150);
            const angle = (normalizedValue / 150) * 180;
            const color = getPerformanceColor(value);
            
            return (
                <div className="racing-gauge" style={{ width: size * 2, height: size }}>
                    <svg width={size * 2} height={size} viewBox={`0 0 ${size * 2} ${size}`}>
                        <path
                            d={`M 20 ${size - 20} A ${size - 40} ${size - 40} 0 0 1 ${size * 2 - 20} ${size - 20}`}
                            className="gauge-bg"
                        />
                        <path
                            d={`M 20 ${size - 20} A ${size - 40} ${size - 40} 0 0 1 ${size * 2 - 20} ${size - 20}`}
                            className="gauge-progress"
                            stroke={color}
                            strokeDasharray={`${(angle / 180) * Math.PI * (size - 40)} ${Math.PI * (size - 40)}`}
                        />
                        <line
                            x1={size}
                            y1={size - 20}
                            x2={size + (size - 50) * Math.cos((180 - angle) * Math.PI / 180)}
                            y2={size - 20 - (size - 50) * Math.sin((180 - angle) * Math.PI / 180)}
                            stroke="#fff"
                            strokeWidth="3"
                            strokeLinecap="round"
                        />
                        <circle cx={size} cy={size - 20} r="8" fill="#fff" />
                    </svg>
                    <div className="text-center mt-2">
                        <div className="text-2xl font-bold" style={{ color }}>{value.toFixed(1)}%</div>
                        <div className="text-sm text-gray-400">{label}</div>
                    </div>
                </div>
            );
        };
        
        // Team Racing Card Component
        const TeamRacingCard = ({ team }) => {
            const performanceClass = `performance-${getPerformanceCategory(team.team_achievement_rate).toLowerCase().replace('_', '-')}`;
            const circuitClass = `circuit-${team.circuit}`;
            
            return (
                <div className={`p-6 rounded-lg shadow-lg ${circuitClass} text-white mb-4`}>
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-xl font-bold">üèéÔ∏è {team.supervisor_name}</h3>
                        <span className="text-2xl font-bold">{team.team_achievement_rate.toFixed(1)}%</span>
                    </div>
                    
                    <div className="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <div className="text-sm opacity-80">Total Sales</div>
                            <div className="text-lg font-semibold">R{team.total_sales.toLocaleString()}</div>
                        </div>
                        <div>
                            <div className="text-sm opacity-80">Target</div>
                            <div className="text-lg font-semibold">R{team.total_target.toLocaleString()}</div>
                        </div>
                    </div>
                    
                    <div className="mb-4">
                        <div className="text-sm opacity-80 mb-2">Pit Crew ({team.consultants.length})</div>
                        <div className="grid grid-cols-1 gap-2">
                            {team.consultants.map(consultant => (
                                <div key={consultant.id} className="flex justify-between bg-black/20 p-2 rounded">
                                    <span>{consultant.name}</span>
                                    <span>{consultant.achievement_rate.toFixed(1)}%</span>
                                </div>
                            ))}
                        </div>
                    </div>
                    
                    <div className="text-center">
                        <div className={`inline-block px-4 py-2 rounded-full text-sm font-semibold ${performanceClass}`}>
                            {getPerformanceCategory(team.team_achievement_rate).replace('_', ' ')}
                        </div>
                    </div>
                </div>
            );
        };
        
        // Main F1 Racing Dashboard Test Component
        const F1RacingDashboardTest = () => {
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                // Simulate loading and processing Excel data
                setTimeout(() => {
                    const processedData = processExcelData(mockExcelData);
                    setData(processedData);
                    setLoading(false);
                }, 1000);
            }, []);
            
            const companyMetrics = useMemo(() => {
                if (!data) return null;
                
                const totalSales = data.teams.reduce((sum, team) => sum + team.total_sales, 0);
                const totalTarget = data.teams.reduce((sum, team) => sum + team.total_target, 0);
                const overallAchievement = (totalSales / totalTarget) * 100;
                
                return {
                    total_sales: totalSales,
                    total_target: totalTarget,
                    overall_achievement_rate: overallAchievement,
                    total_consultants: data.consultants.length,
                    total_teams: data.teams.length
                };
            }, [data]);
            
            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-4xl mb-4">üèéÔ∏è</div>
                            <div className="text-xl">Loading F1 Racing Dashboard...</div>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="min-h-screen p-8">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold mb-2">üèÅ F1 Sales Racing Dashboard</h1>
                            <p className="text-xl text-gray-400">Next.js Integration Test</p>
                        </div>
                        
                        {/* Company Overview */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                            <div className="bg-gray-800 p-6 rounded-lg text-center">
                                <RacingGauge 
                                    value={companyMetrics.overall_achievement_rate} 
                                    label="Overall Performance"
                                    size={100}
                                />
                            </div>
                            <div className="bg-gray-800 p-6 rounded-lg">
                                <h3 className="text-lg font-bold mb-4">Company Metrics</h3>
                                <div className="space-y-2">
                                    <div className="flex justify-between">
                                        <span>Total Sales:</span>
                                        <span className="font-semibold">R{companyMetrics.total_sales.toLocaleString()}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Total Target:</span>
                                        <span className="font-semibold">R{companyMetrics.total_target.toLocaleString()}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Teams:</span>
                                        <span className="font-semibold">{companyMetrics.total_teams}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Consultants:</span>
                                        <span className="font-semibold">{companyMetrics.total_consultants}</span>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-gray-800 p-6 rounded-lg">
                                <h3 className="text-lg font-bold mb-4">Integration Status</h3>
                                <div className="space-y-2">
                                    <div className="flex items-center">
                                        <span className="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                                        <span>Excel Processing ‚úì</span>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                                        <span>Racing Components ‚úì</span>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                                        <span>Circuit Assignment ‚úì</span>
                                    </div>
                                    <div className="flex items-center">
                                        <span className="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                                        <span>Performance Calculation ‚úì</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Team Racing Grid */}
                        <div className="mb-8">
                            <h2 className="text-2xl font-bold mb-6">üèéÔ∏è Team Racing Standings</h2>
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                {data.teams
                                    .sort((a, b) => b.team_achievement_rate - a.team_achievement_rate)
                                    .map(team => (
                                        <TeamRacingCard key={team.id} team={team} />
                                    ))}
                            </div>
                        </div>
                        
                        {/* Footer */}
                        <div className="text-center text-gray-400">
                            <p>‚úÖ F1 Racing Dashboard extraction package working successfully!</p>
                            <p>Ready for integration into your Next.js application</p>
                        </div>
                    </div>
                </div>
            );
        };
        
        // Render the test application
        ReactDOM.render(<F1RacingDashboardTest />, document.getElementById('root'));
    </script>
</body>
</html>